\begin{figure*}[hp]
             \begin{subfigure}[b]{\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/legend.tikz}
            \caption{Legend. Add concatenation symbol...?}
            \label{fig:legend_lstm}
        \end{subfigure}
        \vskip\baselineskip
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/3_forget_gate.tikz}
            \caption{ The forget gate: 
            \begin{math} \protect f_t = \sigma \left( W_f \dot [ h_{t-h}, x_{t} ] + b_f \right) \end{math}  }
            
            \label{fig:forget_gate}
        \end{subfigure}
        \quad
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/4_input_gate.tikz}
            \caption[]
            {Candidate information: $\Tilde{C_t} = tanh \left( W_C \dot [ h_{t-1}, x_t ] + b_C \right)$   The input gate: $i_t = \sigma \left( W_i \dot [ h_{t-1}, x_t ] + b_i \right)$}

            \label{fig:input_gate}
        \end{subfigure}
                \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/5_update_cell_state.tikz}
            \caption[]%
            {{\small Updating the cell state, $C_t = f_t * C_{t-1} + i_t*\Tilde{C_t}$}}

            \label{fig:update_memory}
        \end{subfigure}
        \quad
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/6_output_gate.tikz}
            \caption[]
            {{\small The output gate: $ \protect o_t =\sigma \left( W_o \dot [ h_{t-1}, x_t ] + b_o\right) $ Updating the hidden state, $ \protect h_t = o_t*tanh \left( C_t \right) $ }}

            \label{fig:output_gate}

        \end{subfigure}

        \caption{Walk trough the components of a LSTM and the relevant equations.
        Let t denote the time step, $\protect \sigma$ is the activation function, $\protect W_{\text{component}, \text{gate}}$, $H_{t}$ denotes the hidden state at time t, $\protect C_{t}$ is the cell state at time t. Inspired by \cite{colah_blog_post}. Extension of example provided by \cite{lstm_cell_tikz}.}
        \label{fig:LSTM_all}
    \end{figure*}