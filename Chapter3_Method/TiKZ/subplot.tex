\begin{figure*}[h] % h means place here if possible
        \begin{subfigure}[b]{\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/legend.tikz}
            \vspace{-5em}
            \label{fig:legend}
        \end{subfigure}
        \vskip\baselineskip
        \begin{subfigure}[b]{0.475\textwidth}  
            \centering 
            \input{Chapter3_Method/TiKZ/lstm.tikz}
            %\vspace{1em}
            \caption{{\small The assembeled \acrshort{lstm} unit.}}
            \label{fig:lstm_unit}
        \end{subfigure} 
        \quad
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/1cell_state_core_idea.tikz}
            \caption{{\small The cell state, the long term dependencies.}}    
            \label{fig:cell_state_information_flow}
            
        \end{subfigure}
        
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            
            \input{Chapter3_Method/TiKZ/3_forget_gate.tikz}
            \caption{ The forget gate: 
            \begin{math} \protect f_t = \sigma \left( W_f \dot [ h_{t-h}, x_{t} ] + b_f \right) \end{math}  }
            \label{fig:forget_gate}
        
        \end{subfigure}
        \quad
       \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
            \input{Chapter3_Method/TiKZ/4_input_gate.tikz}
            \caption{{\small Candidate information:\newline $\Tilde{C_t} = tanh \left( W_C \dot [ h_{t-1}, x_t ] + b_C \right)$  \newline  The input gate: $i_t = \sigma \left( W_i \dot [ h_{t-1}, x_t ] + b_i \right)$}}
            \label{fig:input_gate}
        \end{subfigure}
        \begin{subfigure}[b]{0.475\textwidth}   
            \centering 
             \input{Chapter3_Method/TiKZ/5_update_cell_state.tikz}
            %\vspace{3em}
            \caption[]%
            {{\small Updating the cell state, $C_t = f_t * C_{t-1} + i_t*\Tilde{C_t}$}}
            \label{fig:update_memory}
        \end{subfigure}
        \quad
        \begin{subfigure}[b]{0.475\textwidth}
            \centering
            \input{Chapter3_Method/TiKZ/6_output_gate.tikz}
            \caption[]
            {{\small The output gate: $ \protect o_t =\sigma \left( W_o \dot [ h_{t-1}, x_t ] + b_o\right) $ \\ Updating the hidden state, $ \protect h_t = o_t*tanh \left( C_t \right) $ }}
            \label{fig:output_gate}
        \end{subfigure}
        %Let t denote the time step, $\protect \sigma$ is the activation function, $\protect W_{\text{component}, \text{gate}}$, $H_{t}$ denotes the hidden state at time t, $\protect C_{t}$ is the cell state at time t. 
        \caption{{Walk trough the components of a \acrshort{lstm} and the relevant equations. Extension of example provided by \citepaper{lstm_cell_tikz}, inspired by \citepaper{colah_blog_post}.}}
        \label{fig:LSTM}
    \end{figure*}